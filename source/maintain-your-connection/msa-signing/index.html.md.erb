---
title: MSA signing
weight: 20
---

# Update your Matching Service Adapter signing key and certificate

If your connection to GOV.UK Verify involves a Matching Service Adapter (MSA), you are responsible for keeping its encryption and signing certificates up to date.

You must update the certificates containing your MSA's public keys before they expire. If you don't, your users wont be able to access your service using GOV.UK Verify.

## Step 1. Get a new self-signed signing certificate

<%= partial("partials/get-self-signed-certificates") %>

## Step 2. Upload the new signing certificate

To make GOV.UK Verify Hub use your new encryption self-signed certificate, upload it to the GOV.UK Verify Service Admin tool.

Uploading your new certificate causes a configuration change for GOV.UK Verify Hub.

You will get an e-mail confirmation when the GOV.UK Verify team have deployed your new signing certificate. In the meantime, you can move on to adding the new signing key and certificate to your MSA configuration.

## Step 3. Add the new signing key pair to your MSA configuration

Add your new signing key and self-signed certificate to `signingKeys.secondary` in your MSA configuration, for example:

```yaml
signingKeys:
  primary:
    publicKey:
      certFile: msa_signing_2016.crt
      name: 2016 MSA Signing Key
    privateKey:
      keyFile: msa_signing_2016.pk8
  secondary:
    publicKey:
      certFile: msa_signing_2017.crt
      name: 2017 MSA Signing Key
    privateKey:
      keyFile: msa_signing_2017.pk8
```

Restart the MSA to publish the new signing certificate to its metadata. You must do this because the MSA publishes its certificates containing the public keys in its own metadata at run time. The service provider you’re using reads this metadata and uses the MSA's signing certificate to trust assertions signed by the MSA.

If you’re using the VSP, wait for it to load the MSA metadata. The VSP periodically refreshes its metadata and will log when it has finished. Once it loads the new metadata, the VSP trusts assertions signed with the new MSA signing key.

## Step 4. Delete the old signing key pair

Wait for e-mail confirmation that the GOV.UK Verify team have deployed your new signing certificate before.

Delete the `signingKeys.primary` section and rename `signingKeys.secondary` to `signingKeys.primary`. The MSA now signs the assertions with the new  key.

Restart the MSA to update its metadata to contain only the new signing certificate.

Your service provider now trusts assertions signed with your new MSA signing key.

<%= partial "partials/links" %>
