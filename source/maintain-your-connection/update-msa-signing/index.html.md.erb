---
title: Update your MSA signing key
weight: 50
---

# Update your MSA signing key and certificate

These instructions apply to you if you're using the legacy setup with a Matching Service Adapter (MSA).

The MSA publishes its certificates containing the public keys in its own metadata at run time. The service provider you’re using reads this metadata and uses the MSA's signing certificate to trust assertions signed by the MSA. Therefore you must restart the MSA once you've changed the certificates in the configuration file and make sure your service provider has read the new metadata.

1. Generate a new self-signed signing certificate for your MSA.
1. [Upload your new signing certificate to the GOV.UK Verify Service Admin tool](https://connecting-to-verify-prototype.herokuapp.com/self-serve/before-you-start-msa-signing).
1. Make sure you received e-mail confirmation that the GOV.UK Verify team have deployed your signing certificate.
1. Add your new signing key and self-signed certificate to `signingKeys.secondary` in your MSA configuration, for example:

    ```yaml
    signingKeys:
      primary:
        publicKey:
          certFile: msa_signing_2016.crt
          name: 2016 MSA Signing Key
        privateKey:
          keyFile: msa_signing_2016.pk8
      secondary:
        publicKey:
          certFile: msa_signing_2017.crt
          name: 2017 MSA Signing Key
        privateKey:
          keyFile: msa_signing_2017.pk8
    ```
1. Restart the MSA to publish the new signing certificate to its metadata.

1. Make sure the service provider trusts the new certificate before deleting the old one.

    If you’re using the VSP, wait for it to load the MSA metadata. The VSP periodically refreshes its metadata and will log when it has finished. Once it loads the new metadata, the VSP trusts assertions signed with the new MSA signing key.

1. Delete the `signingKeys.primary` section and rename `signingKeys.secondary` to `signingKeys.primary`. The MSA now signs the assertions with the new  key.

1. Restart the MSA to update its metadata to contain only the new signing certificate.

Your service provider now trusts assertions signed with your new MSA signing key.

<%= partial "partials/links" %>
